{"version":3,"sources":["../../js/mobile.js"],"names":[],"mappings":";;AAAA,IAAI,iBAAiB,SAAS,cAAT,CAAwB,KAAxB,CAArB;;AAEA,IAAI,SAAS,SAAS,cAAT,CAAwB,SAAxB,CAAb;AACA,OAAO,OAAP,GAAiB,aAAa,MAAb,KAAwB,MAAzC;AACA,OAAO,QAAP,GAAkB,YAAW;AAC5B,cAAa,MAAb,GAAsB,OAAO,OAA7B;AACA,CAFD;;AAIA,IAAI,EAAJ;AACA,IAAI,WAAW,SAAS,cAAT,CAAwB,WAAxB,CAAf;AACA,SAAS,OAAT,GAAmB,aAAa,QAAb,KAA0B,OAA7C;AACA,SAAS,QAAT,GAAoB,YAAW;AAC9B,cAAa,QAAb,GAAwB,SAAS,OAAjC;AACA,KAAI,aAAa,QAAb,KAA0B,OAA9B,EAAuC;AACtC,eAAa,EAAb;AACA,EAFD,MAGK;AACJ,eAAa,EAAb;AACA;AACA;AACD,CATD;;AAWA,SAAS,aAAT,CAAuB,aAAvB,EAAsC,OAAtC,GAAgD,YAAW;AAC1D,KAAI,aAAa,MAAb,KAAwB,MAA5B,EAAoC;AACnC,SAAQ,SAAS,IAAT,GAAc,SAAtB;AACA,EAFD,MAGK,IAAI,iBAAiB,SAArB,EAAgC;;AAEpC;AACA,iBAAe,SAAf,GAAyB,qBAAzB;AACA,YAAU,WAAV,CAAsB,kBAAtB,CAAyC,UAAS,CAAT,EAAY;AACpD,kBAAe,SAAf,GAAyB,cAAzB;AACA,YAAS,IAAT,GAAc,iBAAe,EAAE,MAAF,CAAS,QAAxB,GAAiC,OAAjC,GAAyC,EAAE,MAAF,CAAS,SAAhE;AAEA,GAJD,EAIG,UAAS,GAAT,EAAc;AAChB,kBAAe,SAAf,GAAyB,EAAzB;AACA,SAAM,6BAA6B,IAAI,OAAvC;AAEA,GARD,EAQG;AACF,uBAAoB,IADlB;AAEF,YAAS,IAFP;AAGF,eAAY;AAHV,GARH;AAaA,EAjBI,MAkBA;AACJ,QAAM,8CAAN;AACA;AACD,CAzBD;;AA2BA,SAAS,WAAT,GAAuB;AACtB;AACA;AACA;AACA;AACA;AACA,UAAS,gBAAT,CAA0B,YAA1B,EAAwC,OAAxC,CAAgD,UAAS,OAAT,EAAiB;AAChE,MAAI,MAAM,IAAI,IAAJ,GAAW,OAAX,EAAV;AACA,MAAI,gBAAgB,KAAK,KAAL,CAAW,CAAC,MAAM,WAAP,IAAoB,IAA/B,CAApB;AACA,MAAI,WAAY,QAAQ,YAAR,CAAqB,WAArB,CAAhB;AACA,MAAI,SAAS,WAAW,aAAxB;AACA,MAAI,MAAM,KAAK,KAAL,CAAW,SAAS,EAApB,CAAV;AACA,MAAI,MAAM,SAAS,EAAnB;AACA,UAAQ,SAAR,GAAqB,SAAS,CAAV,GAAe,MAAM,OAAN,GAAgB,GAAhB,GAAsB,MAArC,GAA8C,WAAlE;AACA,EARD;AASA,MAAK,WAAW,WAAX,EAAwB,IAAxB,CAAL;AACA;AACD,IAAI,aAAa,QAAb,KAA0B,OAA9B,EAAuC;AACtC;AACA;;AAED,SAAS,gBAAT,CAA0B,IAA1B,EAAgC,OAAhC,CAAwC,UAAS,QAAT,EAAmB;AAC1D,UAAS,OAAT,GAAmB,YAAW;AAC7B,SAAO,QAAP,CAAgB,QAAhB,GAA2B,KAAK,YAAL,CAAkB,MAAlB,CAA3B;AACA,EAFD;AAGA,CAJD","file":"mobile.built.js","sourcesContent":["var loadingMessage = document.getElementById('msg');\r\n\r\nvar useLoc = document.getElementById('use-loc');\r\nuseLoc.checked = localStorage.useLoc === 'true';\r\nuseLoc.onchange = function() {\r\n\tlocalStorage.useLoc = useLoc.checked;\r\n};\r\n\r\nvar tm;\r\nvar useTimer = document.getElementById('use-timer');\r\nuseTimer.checked = localStorage.useTimer !== 'false';\r\nuseTimer.onchange = function() {\r\n\tlocalStorage.useTimer = useTimer.checked;\r\n\tif (localStorage.useTimer === 'false') {\r\n\t\tclearTimeout(tm);\r\n\t}\r\n\telse {\r\n\t\tclearTimeout(tm);\r\n\t\tupdateTimes();\r\n\t}\r\n};\r\n\r\ndocument.querySelector('#nav button').onclick = function() {\r\n\tif (localStorage.useLoc !== 'true') {\r\n\t\treturn (location.href=\"/mobile\");\r\n\t}\r\n\telse if (\"geolocation\" in navigator) {\r\n\r\n\t\t// Getting the GPS position can be very slow on some devices\r\n\t\tloadingMessage.innerText='Getting location...';\r\n\t\tnavigator.geolocation.getCurrentPosition(function(p) {\r\n\t\t\tloadingMessage.innerText='Reloading...';\r\n\t\t\tlocation.href='/mobile?lat='+p.coords.latitude+'&lon='+p.coords.longitude;\r\n\r\n\t\t}, function(err) {\r\n\t\t\tloadingMessage.innerText='';\r\n\t\t\talert('Failed to get location: ' + err.message);\r\n\r\n\t\t}, {\r\n\t\t\tenableHighAccuracy: true,\r\n\t\t\ttimeout: 5000,\r\n\t\t\tmaximumAge: 5000\r\n\t\t});\r\n\t}\r\n\telse {\r\n\t\talert('Your device does not support web geolocation');\r\n\t}\r\n};\r\n\r\nfunction updateTimes() {\r\n\t// server tells us how many seconds are left we note the\r\n\t// pageload time and count down from there.\r\n\t// Yes, this could be a smidge innaccurate, but not by\r\n\t// more than 1 second or so which doesn't matter.\r\n\t// And now we don't have to deal with timestamps and dates!\r\n\tdocument.querySelectorAll('div.remain').forEach(function(element){\r\n\t\tvar now = new Date().getTime();\r\n\t\tvar secondsPassed = Math.floor((now - page_loaded)/1000);\r\n\t\tvar alivefor =  element.getAttribute('disappear');\r\n\t\tvar remain = alivefor - secondsPassed;\r\n\t\tvar min = Math.floor(remain / 60);\r\n\t\tvar sec = remain % 60;\r\n\t\telement.innerText = (remain > 0) ? min + ' min ' + sec + ' sec' : '(expired)';\r\n\t});\r\n\ttm = setTimeout(updateTimes, 1000);\r\n};\r\nif (localStorage.useTimer !== 'false') {\r\n\tupdateTimes();\r\n}\r\n\r\ndocument.querySelectorAll(\"li\").forEach(function(listItem) {\r\n\tlistItem.onclick = function() {\r\n\t\twindow.document.location = this.getAttribute('href');\r\n\t};\r\n});\r\n"]}