{"version":3,"sources":["../../js/mobile.js"],"names":[],"mappings":";;AAAA,IAAI,iBAAiB,SAAS,cAAT,CAAwB,KAAxB,CAArB;;AAEA,IAAI,SAAS,SAAS,cAAT,CAAwB,SAAxB,CAAb;AACA,OAAO,OAAP,GAAiB,aAAa,MAAb,KAAwB,MAAzC;AACA,OAAO,QAAP,GAAkB,YAAW;AAC3B,eAAa,MAAb,GAAsB,OAAO,OAA7B;AACD,CAFD;;AAIA,IAAI,EAAJ;AACA,IAAI,WAAW,SAAS,cAAT,CAAwB,WAAxB,CAAf;AACA,SAAS,OAAT,GAAmB,aAAa,QAAb,KAA0B,OAA7C;AACA,SAAS,QAAT,GAAoB,YAAW;AAC7B,eAAa,QAAb,GAAwB,SAAS,OAAjC;AACA,MAAI,aAAa,QAAb,KAA0B,OAA9B,EAAuC;AACrC,iBAAa,EAAb;AACD,GAFD,MAEO;AACL,iBAAa,EAAb;AACA;AACD;AACF,CARD;;AAUA,SAAS,aAAT,CAAuB,aAAvB,EAAsC,OAAtC,GAAgD,YAAW;AACzD,MAAI,aAAa,MAAb,KAAwB,MAA5B,EAAoC;AAClC,WAAQ,SAAS,IAAT,GAAgB,SAAxB;AACD,GAFD,MAEO,IAAI,iBAAiB,SAArB,EAAgC;AACrC;AACA,mBAAe,SAAf,GAA2B,qBAA3B;AACA,cAAU,WAAV,CAAsB,kBAAtB,CAAyC,UAAS,CAAT,EAAY;AACnD,qBAAe,SAAf,GAA2B,cAA3B;AACA,eAAS,IAAT,GAAgB,iBAAiB,EAAE,MAAF,CAAS,QAA1B,GAAqC,OAArC,GAA+C,EAAE,MAAF,CAAS,SAAxE;AACD,KAHD,EAGG,UAAS,GAAT,EAAc;AACf,qBAAe,SAAf,GAA2B,EAA3B;AACA,YAAM,6BAA6B,IAAI,OAAvC;AACD,KAND,EAMG;AACD,0BAAoB,IADnB;AAED,eAAS,IAFR;AAGD,kBAAY;AAHX,KANH;AAWD,GAdM,MAcA;AACL,UAAM,8CAAN;AACD;AACF,CApBD;;AAsBA,SAAS,WAAT,GAAuB;AACrB;AACA;AACA;AACA;AACA;AACA,WAAS,gBAAT,CAA0B,YAA1B,EAAwC,OAAxC,CAAgD,UAAS,OAAT,EAAkB;AAChE,QAAI,MAAM,IAAI,IAAJ,GAAW,OAAX,EAAV;AACA,QAAI,gBAAgB,KAAK,KAAL,CAAW,CAAC,MAAM,WAAP,IAAsB,IAAjC,CAApB;AACA,QAAI,WAAW,QAAQ,YAAR,CAAqB,WAArB,CAAf;AACA,QAAI,SAAS,WAAW,aAAxB;AACA,QAAI,MAAM,KAAK,KAAL,CAAW,SAAS,EAApB,CAAV;AACA,QAAI,MAAM,SAAS,EAAnB;AACA,YAAQ,SAAR,GAAqB,SAAS,CAAV,GAAe,MAAM,OAAN,GAAgB,GAAhB,GAAsB,MAArC,GAA8C,WAAlE;AACD,GARD;AASA,OAAK,WAAW,WAAX,EAAwB,IAAxB,CAAL;AACD;AACD,IAAI,aAAa,QAAb,KAA0B,OAA9B,EAAuC;AACrC;AACD;;AAED,SAAS,gBAAT,CAA0B,IAA1B,EAAgC,OAAhC,CAAwC,UAAS,QAAT,EAAmB;AACzD,WAAS,OAAT,GAAmB,YAAW;AAC5B,WAAO,QAAP,CAAgB,QAAhB,GAA2B,KAAK,YAAL,CAAkB,MAAlB,CAA3B;AACD,GAFD;AAGD,CAJD","file":"mobile.built.js","sourcesContent":["var loadingMessage = document.getElementById('msg');\r\n\r\nvar useLoc = document.getElementById('use-loc');\r\nuseLoc.checked = localStorage.useLoc === 'true';\r\nuseLoc.onchange = function() {\r\n  localStorage.useLoc = useLoc.checked;\r\n};\r\n\r\nvar tm;\r\nvar useTimer = document.getElementById('use-timer');\r\nuseTimer.checked = localStorage.useTimer !== 'false';\r\nuseTimer.onchange = function() {\r\n  localStorage.useTimer = useTimer.checked;\r\n  if (localStorage.useTimer === 'false') {\r\n    clearTimeout(tm);\r\n  } else {\r\n    clearTimeout(tm);\r\n    updateTimes();\r\n  }\r\n};\r\n\r\ndocument.querySelector('#nav button').onclick = function() {\r\n  if (localStorage.useLoc !== 'true') {\r\n    return (location.href = \"/mobile\");\r\n  } else if (\"geolocation\" in navigator) {\r\n    // Getting the GPS position can be very slow on some devices\r\n    loadingMessage.innerText = 'Getting location...';\r\n    navigator.geolocation.getCurrentPosition(function(p) {\r\n      loadingMessage.innerText = 'Reloading...';\r\n      location.href = '/mobile?lat=' + p.coords.latitude + '&lon=' + p.coords.longitude;\r\n    }, function(err) {\r\n      loadingMessage.innerText = '';\r\n      alert('Failed to get location: ' + err.message);\r\n    }, {\r\n      enableHighAccuracy: true,\r\n      timeout: 5000,\r\n      maximumAge: 5000\r\n    });\r\n  } else {\r\n    alert('Your device does not support web geolocation');\r\n  }\r\n};\r\n\r\nfunction updateTimes() {\r\n  // server tells us how many seconds are left we note the\r\n  // pageload time and count down from there.\r\n  // Yes, this could be a smidge innaccurate, but not by\r\n  // more than 1 second or so which doesn't matter.\r\n  // And now we don't have to deal with timestamps and dates!\r\n  document.querySelectorAll('div.remain').forEach(function(element) {\r\n    var now = new Date().getTime();\r\n    var secondsPassed = Math.floor((now - page_loaded) / 1000);\r\n    var alivefor = element.getAttribute('disappear');\r\n    var remain = alivefor - secondsPassed;\r\n    var min = Math.floor(remain / 60);\r\n    var sec = remain % 60;\r\n    element.innerText = (remain > 0) ? min + ' min ' + sec + ' sec' : '(expired)';\r\n  });\r\n  tm = setTimeout(updateTimes, 1000);\r\n};\r\nif (localStorage.useTimer !== 'false') {\r\n  updateTimes();\r\n}\r\n\r\ndocument.querySelectorAll(\"li\").forEach(function(listItem) {\r\n  listItem.onclick = function() {\r\n    window.document.location = this.getAttribute('href');\r\n  };\r\n});\r\n"]}